<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Bridge | Professional Placements</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">

    <style>
        :root {
            --primary: #2563eb;
            --bg-main: #f1f5f9;
            --card-surface: #ffffff;
            --border-color: #e2e8f0;
            --text-main: #0f172a;
            --text-dim: #64748b;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: var(--bg-main);
            color: var(--text-main);
        }

        header {
            height: 70px;
            background: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 5%;
            border-bottom: 1px solid var(--border-color);
        }

        .logo {
            font-size: 22px;
            font-weight: 800;
            color: var(--primary);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .top-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        main {
            max-width: 1000px;
            margin: 30px auto;
            padding: 0 20px;
        }

        .dashboard-container {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            border-radius: 30px;
            padding: 40px;
            margin-bottom: 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
        }

        .main-avatar {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: 800;
            color: var(--primary);
        }

        .stat-item {
            text-align: left;
            padding: 0 25px;
            border-left: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-value {
            font-size: 26px;
            font-weight: 800;
        }

        .stat-label {
            font-size: 10px;
            text-transform: uppercase;
            color: #94a3b8;
        }

        .section-header {
            margin: 30px 0 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-header h3 {
            font-size: 14px;
            color: var(--text-dim);
            text-transform: uppercase;
        }

        .section-header .line {
            flex: 1;
            height: 1px;
            background: var(--border-color);
        }

        .task-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .long-card {
            background: var(--card-surface);
            padding: 24px 30px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-left: 8px solid var(--primary);
            cursor: pointer;
            transition: 0.3s;
        }

        .long-card:hover {
            transform: translateX(8px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
        }

        .company-name {
            font-size: 11px;
            text-transform: uppercase;
            color: var(--primary);
            font-weight: 800;
        }

        .task-name {
            font-size: 18px;
            font-weight: 700;
            margin: 4px 0;
        }

        .primary-btn {
            background: var(--primary);
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer;
        }

        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            display: none;
            align-items: center;
            justify-content: center;
        }

        .modal {
            background: white;
            padding: 40px;
            border-radius: 25px;
            width: 90%;
            max-width: 500px;
        }
    </style>
</head>

<body>

    <header>
        <div class="logo">TASK BRIDGE</div>
        <div class="header-right">
            <a href="login.html"><span class="sign-out">Sign Out</span></a>
            <div class="top-avatar">{{org[0][0]}}</div>
        </div>
    </header>

    <main>

        <div class="dashboard-container">
            <div style="display:flex; align-items:center; gap:20px;">
                <div class="main-avatar">{{org[0][0]}}</div>
                <div>
                    <h2 style="font-size:28px; font-weight:800;">{{org[0]}}</h2>
                    <p style="color:#94a3b8;">{{org[2]}}</p>
                </div>
            </div>
            <div style="display:flex;">
                <div class="stat-item">
                    <span class="stat-value" id="member-count">3</span>
                    <span class="stat-label">Active Members</span>
                </div>
            </div>
        </div>

        <!-- ADD TASK BUTTON (NO UI CHANGE TO EXISTING) -->
        <div style="margin-bottom:20px;">
            <button class="primary-btn" onclick="openAddTaskModal()">+ Add Task</button>
        </div>

        <div class="section-header">
            <h3>Active Team Members</h3>
            <div class="line"></div>
        </div>

        <div class="task-list" id="assigned-container"></div>

    </main>

    <!-- EXISTING MODAL -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal">
            <div id="modal-content"></div>
            <button
                style="margin-top:20px; width:100%; padding:15px; border:none; border-radius:15px; background:#f1f5f9; cursor:pointer; font-weight:700;"
                onclick="closeModal()">Close</button>
        </div>
    </div>

    <!-- NEW ADD TASK MODAL -->
    <div class="modal-overlay" id="taskModal">
        <div class="modal">
            <h2>Add New Task</h2>

            <!-- Task ID (auto generated) -->
            <input id="taskId" placeholder="Task ID" readonly
                style="width:100%; padding:12px; margin-top:15px; border:1px solid #e2e8f0; border-radius:12px; background:#f8fafc; font-weight:600;">

            <!-- Task Title -->
            <input id="taskTitle" placeholder="Task Title"
                style="width:100%; padding:12px; margin-top:15px; border:1px solid #e2e8f0; border-radius:12px;">

            <!-- Task Description -->
            <textarea id="taskDesc" placeholder="Task Description"
                style="width:100%; padding:12px; margin-top:15px; border:1px solid #e2e8f0; border-radius:12px;"></textarea>

            <!-- Deadline -->
            <label for="deadline">Deadline</label>
            <input type="date" id="deadline"
                style="width:100%; padding:12px; margin-top:15px; border:1px solid #e2e8f0; border-radius:12px;">


            <!-- Required Skillsets -->
            <input id="skillsets" placeholder="Required Skillsets (comma separated)"
                style="width:100%; padding:12px; margin-top:15px; border:1px solid #e2e8f0; border-radius:12px;">

            <!-- Eligibility Score -->
            <input type="number" id="eligibilityScore" placeholder="Eligibility Score"
                style="width:100%; padding:12px; margin-top:15px; border:1px solid #e2e8f0; border-radius:12px;">

            <!-- Org ID -->
            <input id="orgId" placeholder="Organization ID"
                style="width:100%; padding:12px; margin-top:15px; border:1px solid #e2e8f0; border-radius:12px;">

            <!-- Buttons -->
            <button class="primary-btn" style="width:100%; margin-top:20px;" onclick="addTask()">
                Create Task
            </button>

            <button
                style="margin-top:10px; width:100%; padding:15px; border:none; border-radius:15px; background:#f1f5f9; cursor:pointer; font-weight:700;"
                onclick="closeTaskModal()">
                Cancel
            </button>
        </div>
    </div>

    <script>
        // generate random Task ID when modal opens
        function generateTaskId() {
            return "TASK-" + Math.floor(100000 + Math.random() * 900000);
        }

        // call this when opening modal
        function openTaskModal() {
            document.getElementById("taskModal").style.display = "flex";
            document.getElementById("taskId").value = generateTaskId();
        }

        function closeTaskModal() {
            document.getElementById("taskModal").style.display = "none";
        }

        function openAddTaskModal() {
            document.getElementById('taskModal').style.display = 'flex';
        }

        function closeTaskModal() {
            document.getElementById('taskModal').style.display = 'none';
        }
        // example addTask function
        function addTask() {

    const sysdate = new Date();

    const formattedSysdate = sysdate.getFullYear() + "-" +
        String(sysdate.getMonth() + 1).padStart(2, '0') + "-" +
        String(sysdate.getDate()).padStart(2, '0') + " " +
        String(sysdate.getHours()).padStart(2, '0') + ":" +
        String(sysdate.getMinutes()).padStart(2, '0') + ":" +
        String(sysdate.getSeconds()).padStart(2, '0');

    const task = {
        taskId: parseInt(document.getElementById("taskId").value),
        title: document.getElementById("taskTitle").value,
        description: document.getElementById("taskDesc").value,
        deadline: document.getElementById("deadline").value,
        joinDate: formattedSysdate, 
        skillsets: document.getElementById("skillsets").value,
        eligibilityScore: parseInt(document.getElementById("eligibilityScore").value),
        orgId: document.getElementById("orgId").value
    };

    fetch("/add-task", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify(task)
    })
    .then(response => response.json())
    .then(data => {
        alert(data.message);
        closeTaskModal();
    })
    .catch(error => {
        console.error("Error:", error);
    });
}

        
    </script>

    <script>

        const organizationMembers = [
            { name: "Sarah Mitchell", role: "UI/UX Designer", ats: 88, skills: ["Figma", "UX Research", "Accessibility"], experience: "3 Years", email: "sarah.m@unicef.org", currentTask: null },
            { name: "Daniel Wong", role: "Frontend Engineer", ats: 91, skills: ["React", "TypeScript", "Performance"], experience: "4 Years", email: "daniel.w@unicef.org", currentTask: null },
            { name: "Priya Sharma", role: "Data Analyst", ats: 84, skills: ["Python", "SQL", "Data Visualization"], experience: "2 Years", email: "priya.s@unicef.org", currentTask: null }
        ];

        let tasks = [];

        function init() {
            const container = document.getElementById('assigned-container');
            container.innerHTML = "";

            organizationMembers.forEach(member => {
                const card = document.createElement('div');
                card.className = 'long-card';
                card.onclick = () => openMemberModal(member);

                card.innerHTML = `
            <div>
                <span class="company-name">{{org[0]}}</span>
                <h3 class="task-name">${member.name}</h3>
                <p style="color:var(--text-dim); font-weight:600;">
                    ${member.role}
                </p>
            </div>

            <div>
                <span style="font-size:12px; color:var(--text-dim);">Current Task</span>
                <p style="font-weight:800; color:var(--primary);">
                    ${member.currentTask ? member.currentTask : "None"}
                </p>
            </div>

            <button class="primary-btn">View Profile</button>
        `;

                container.appendChild(card);
            });
        }

        function openMemberModal(member) {
            const content = document.getElementById('modal-content');

            content.innerHTML = `
        <span class="company-name">UNICEF INDIA TEAM</span>
        <h2 style="margin:15px 0;">${member.name}</h2>
        <p style="color:var(--text-dim); font-weight:600;">${member.role}</p>

        <div style="margin-top:20px; padding:20px; background:#f8fafc; border-radius:15px;">
            <p><strong>Current Task:</strong> ${member.currentTask || "None"}</p>
            <p><strong>ATS Score:</strong> ${member.ats}%</p>
            <p><strong>Experience:</strong> ${member.experience}</p>
            <p><strong>Email:</strong> ${member.email}</p>
        </div>

        <button class="primary-btn" style="width:100%; margin-top:25px; padding:15px;"
            onclick="assignTaskPrompt('${member.name}')">
            Assign Task
        </button>
    `;

            document.getElementById('modalOverlay').style.display = 'flex';
        }

        function assignTaskPrompt(memberName) {
            if (tasks.length === 0) {
                alert("No tasks available.");
                return;
            }

            const member = organizationMembers.find(m => m.name === memberName);

            if (member.currentTask) {
                alert("This member is already working on a task.");
                return;
            }

            member.currentTask = tasks[0].title;
            tasks.shift();

            closeModal();
            init();
        }

        

        // function addTask() {
        //     const title = document.getElementById('taskTitle').value;
        //     const desc = document.getElementById('taskDesc').value;

        //     if (!title || !desc) {
        //         alert("Fill all fields");
        //         return;
        //     }

        //     tasks.push({ title, desc });

        //     document.getElementById('taskTitle').value = "";
        //     document.getElementById('taskDesc').value = "";
        //     closeTaskModal();
        //     alert("Task Created Successfully");
        // }

        function closeModal() {
            document.getElementById('modalOverlay').style.display = 'none';
        }

        init();

    </script>

</body>

</html>